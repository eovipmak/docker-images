import{a as v,g as f,r as u,u as C,j as e,s as T,c as w,d as S,T as d,m as $,b as j,v as ee,w as te,x as A,e as Y,l as E,P as H,p as b,q as se,t as oe,C as re}from"./index-gi0veGr1.js";import{c as ae,E as D,a as F,G as k,C as ne}from"./api-DKDneNWW.js";import{T as ie}from"./TextField-CbQp3c7o.js";import{A as N}from"./Alert--JD6T1OI.js";function le(t){return v("MuiAlertTitle",t)}f("MuiAlertTitle",["root"]);const ce=t=>{const{classes:s}=t;return S({root:["root"]},le,s)},de=T(d,{name:"MuiAlertTitle",slot:"Root",overridesResolver:(t,s)=>s.root})($(({theme:t})=>({fontWeight:t.typography.fontWeightMedium,marginTop:-2}))),U=u.forwardRef(function(s,o){const r=C({props:s,name:"MuiAlertTitle"}),{className:a,...n}=r,l=r,i=ce(l);return e.jsx(de,{gutterBottom:!0,component:"div",ownerState:l,ref:o,className:w(i.root,a),...n})}),Q=u.createContext();function pe(t){return v("MuiTable",t)}f("MuiTable",["root","stickyHeader"]);const ue=t=>{const{classes:s,stickyHeader:o}=t;return S({root:["root",o&&"stickyHeader"]},pe,s)},he=T("table",{name:"MuiTable",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:o}=t;return[s.root,o.stickyHeader&&s.stickyHeader]}})($(({theme:t})=>({display:"table",width:"100%",borderCollapse:"collapse",borderSpacing:0,"& caption":{...t.typography.body2,padding:t.spacing(2),color:(t.vars||t).palette.text.secondary,textAlign:"left",captionSide:"bottom"},variants:[{props:({ownerState:s})=>s.stickyHeader,style:{borderCollapse:"separate"}}]}))),V="table",q=u.forwardRef(function(s,o){const r=C({props:s,name:"MuiTable"}),{className:a,component:n=V,padding:l="normal",size:i="medium",stickyHeader:p=!1,...x}=r,h={...r,component:n,padding:l,size:i,stickyHeader:p},m=ue(h),B=u.useMemo(()=>({padding:l,size:i,stickyHeader:p}),[l,i,p]);return e.jsx(Q.Provider,{value:B,children:e.jsx(he,{as:n,role:n===V?null:"table",ref:o,className:w(m.root,a),ownerState:h,...x})})}),I=u.createContext();function xe(t){return v("MuiTableBody",t)}f("MuiTableBody",["root"]);const ge=t=>{const{classes:s}=t;return S({root:["root"]},xe,s)},me=T("tbody",{name:"MuiTableBody",slot:"Root",overridesResolver:(t,s)=>s.root})({display:"table-row-group"}),ye={variant:"body"},G="tbody",_=u.forwardRef(function(s,o){const r=C({props:s,name:"MuiTableBody"}),{className:a,component:n=G,...l}=r,i={...r,component:n},p=ge(i);return e.jsx(I.Provider,{value:ye,children:e.jsx(me,{className:w(p.root,a),as:n,ref:o,role:n===G?null:"rowgroup",ownerState:i,...l})})});function be(t){return v("MuiTableCell",t)}const je=f("MuiTableCell",["root","head","body","footer","sizeSmall","sizeMedium","paddingCheckbox","paddingNone","alignLeft","alignCenter","alignRight","alignJustify","stickyHeader"]),ve=t=>{const{classes:s,variant:o,align:r,padding:a,size:n,stickyHeader:l}=t,i={root:["root",o,l&&"stickyHeader",r!=="inherit"&&`align${j(r)}`,a!=="normal"&&`padding${j(a)}`,`size${j(n)}`]};return S(i,be,s)},fe=T("td",{name:"MuiTableCell",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:o}=t;return[s.root,s[o.variant],s[`size${j(o.size)}`],o.padding!=="normal"&&s[`padding${j(o.padding)}`],o.align!=="inherit"&&s[`align${j(o.align)}`],o.stickyHeader&&s.stickyHeader]}})($(({theme:t})=>({...t.typography.body2,display:"table-cell",verticalAlign:"inherit",borderBottom:t.vars?`1px solid ${t.vars.palette.TableCell.border}`:`1px solid
    ${t.palette.mode==="light"?ee(A(t.palette.divider,1),.88):te(A(t.palette.divider,1),.68)}`,textAlign:"left",padding:16,variants:[{props:{variant:"head"},style:{color:(t.vars||t).palette.text.primary,lineHeight:t.typography.pxToRem(24),fontWeight:t.typography.fontWeightMedium}},{props:{variant:"body"},style:{color:(t.vars||t).palette.text.primary}},{props:{variant:"footer"},style:{color:(t.vars||t).palette.text.secondary,lineHeight:t.typography.pxToRem(21),fontSize:t.typography.pxToRem(12)}},{props:{size:"small"},style:{padding:"6px 16px",[`&.${je.paddingCheckbox}`]:{width:24,padding:"0 12px 0 16px","& > *":{padding:0}}}},{props:{padding:"checkbox"},style:{width:48,padding:"0 0 0 4px"}},{props:{padding:"none"},style:{padding:0}},{props:{align:"left"},style:{textAlign:"left"}},{props:{align:"center"},style:{textAlign:"center"}},{props:{align:"right"},style:{textAlign:"right",flexDirection:"row-reverse"}},{props:{align:"justify"},style:{textAlign:"justify"}},{props:({ownerState:s})=>s.stickyHeader,style:{position:"sticky",top:0,zIndex:2,backgroundColor:(t.vars||t).palette.background.default}}]}))),c=u.forwardRef(function(s,o){const r=C({props:s,name:"MuiTableCell"}),{align:a="inherit",className:n,component:l,padding:i,scope:p,size:x,sortDirection:h,variant:m,...B}=r,y=u.useContext(Q),M=u.useContext(I),L=M&&M.variant==="head";let R;l?R=l:R=L?"th":"td";let z=p;R==="td"?z=void 0:!z&&L&&(z="col");const P=m||M&&M.variant,O={...r,align:a,component:R,padding:i||(y&&y.padding?y.padding:"normal"),size:x||(y&&y.size?y.size:"medium"),sortDirection:h,stickyHeader:P==="head"&&y&&y.stickyHeader,variant:P},Z=ve(O);let W=null;return h&&(W=h==="asc"?"ascending":"descending"),e.jsx(fe,{as:R,ref:o,className:w(Z.root,n),"aria-sort":W,scope:z,ownerState:O,...B})});function Ce(t){return v("MuiTableContainer",t)}f("MuiTableContainer",["root"]);const Te=t=>{const{classes:s}=t;return S({root:["root"]},Ce,s)},we=T("div",{name:"MuiTableContainer",slot:"Root",overridesResolver:(t,s)=>s.root})({width:"100%",overflowX:"auto"}),J=u.forwardRef(function(s,o){const r=C({props:s,name:"MuiTableContainer"}),{className:a,component:n="div",...l}=r,i={...r,component:n},p=Te(i);return e.jsx(we,{ref:o,as:n,className:w(p.root,a),ownerState:i,...l})});function Se(t){return v("MuiTableRow",t)}const K=f("MuiTableRow",["root","selected","hover","head","footer"]),Re=t=>{const{classes:s,selected:o,hover:r,head:a,footer:n}=t;return S({root:["root",o&&"selected",r&&"hover",a&&"head",n&&"footer"]},Se,s)},ke=T("tr",{name:"MuiTableRow",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:o}=t;return[s.root,o.head&&s.head,o.footer&&s.footer]}})($(({theme:t})=>({color:"inherit",display:"table-row",verticalAlign:"middle",outline:0,[`&.${K.hover}:hover`]:{backgroundColor:(t.vars||t).palette.action.hover},[`&.${K.selected}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:A(t.palette.primary.main,t.palette.action.selectedOpacity),"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:A(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity)}}}))),X="tr",g=u.forwardRef(function(s,o){const r=C({props:s,name:"MuiTableRow"}),{className:a,component:n=X,hover:l=!1,selected:i=!1,...p}=r,x=u.useContext(I),h={...r,component:n,hover:l,selected:i,head:x&&x.variant==="head",footer:x&&x.variant==="footer"},m=Re(h);return e.jsx(ke,{as:n,ref:o,className:w(m.root,a),role:n===X?null:"row",ownerState:h,...p})}),Me=Y(e.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search"),ze=Y(e.jsx("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"}),"Warning"),Ae=({onResult:t})=>{const{t:s}=E(),[o,r]=u.useState(""),[a,n]=u.useState(!1),[l,i]=u.useState(""),p=async x=>{if(x.preventDefault(),i(""),!o.trim()){i(s("provideDomain"));return}n(!0);try{const h=await ae(o);t(h)}catch(h){const m=h instanceof Error?h.message:s("checkFailed");i(m),t({status:"error",error:m})}finally{n(!1)}};return e.jsxs(H,{elevation:2,sx:{p:3},children:[e.jsx(d,{variant:"h5",component:"h2",gutterBottom:!0,children:s("formTitle")}),e.jsxs(b,{component:"form",onSubmit:p,noValidate:!0,children:[e.jsx(ie,{fullWidth:!0,label:s("targetLabel"),placeholder:s("targetPlaceholder"),value:o,onChange:x=>r(x.target.value),error:!!l,helperText:l||s("helpText"),disabled:a,margin:"normal",inputProps:{"aria-label":s("targetLabel"),"aria-required":"true"}}),e.jsx(se,{type:"submit",variant:"contained",color:"primary",size:"large",startIcon:a?e.jsx(oe,{size:20,color:"inherit"}):e.jsx(Me,{}),disabled:a,fullWidth:!0,sx:{mt:2},"aria-label":s("checkButton"),children:s(a?"loading":"checkButton")})]})]})},$e={success:"statusSuccess",error:"statusError",warning:"statusWarning"},Be=({result:t})=>{const{t:s}=E();if(!t)return null;if(t.status==="error")return e.jsx(H,{elevation:2,sx:{p:3,mt:3},children:e.jsxs(N,{severity:"error",icon:e.jsx(D,{}),children:[e.jsx(U,{children:s("statusError")}),t.error||s("errorOccurred")]})});const o=t.data;if(!o)return null;const r=o.ssl||{},a=o.ip_info||{},n=()=>{switch(o.sslStatus){case"success":return e.jsx(ne,{color:"success"});case"warning":return e.jsx(ze,{color:"warning"});default:return e.jsx(D,{color:"error"})}},l=()=>{switch(o.sslStatus){case"success":return"success";case"warning":return"warning";default:return"error"}};return e.jsxs(H,{elevation:2,sx:{p:3,mt:3},role:"region","aria-label":s("resultsTitle"),children:[e.jsxs(b,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(b,{display:"flex",alignItems:"center",gap:1,children:[n(),e.jsx(d,{variant:"h5",component:"h2",children:o.domain||o.ip})]}),e.jsx(F,{label:s($e[o.sslStatus]||"statusError"),color:l()})]}),e.jsxs(d,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:[s("ipAddress"),": ",o.ip," | ",s("port"),": ",o.port]}),r&&Object.keys(r).length>0&&e.jsxs(b,{mt:3,children:[e.jsx(d,{variant:"h6",gutterBottom:!0,children:s("sslCertificate")}),e.jsx(J,{children:e.jsx(q,{size:"small","aria-label":s("sslCertificate"),children:e.jsxs(_,{children:[r.subject?.commonName&&e.jsxs(g,{children:[e.jsx(c,{component:"th",scope:"row",children:s("subjectCN")}),e.jsx(c,{children:r.subject.commonName})]}),r.subject?.organizationName&&e.jsxs(g,{children:[e.jsx(c,{component:"th",scope:"row",children:s("subjectOrganization")}),e.jsx(c,{children:r.subject.organizationName})]}),r.issuer?.commonName&&e.jsxs(g,{children:[e.jsx(c,{component:"th",scope:"row",children:s("issuer")}),e.jsx(c,{children:r.issuer.commonName})]}),r.notBefore&&e.jsxs(g,{children:[e.jsx(c,{component:"th",scope:"row",children:s("validFrom")}),e.jsx(c,{children:r.notBefore})]}),r.notAfter&&e.jsxs(g,{children:[e.jsx(c,{component:"th",scope:"row",children:s("validUntil")}),e.jsx(c,{children:r.notAfter})]}),r.daysUntilExpiration!==void 0&&e.jsxs(g,{children:[e.jsx(c,{component:"th",scope:"row",children:s("daysUntilExpiration")}),e.jsx(c,{children:e.jsx(F,{label:`${r.daysUntilExpiration} days`,color:r.daysUntilExpiration<30?"error":"success",size:"small"})})]}),r.tlsVersion&&e.jsxs(g,{children:[e.jsx(c,{component:"th",scope:"row",children:s("tlsVersion")}),e.jsx(c,{children:r.tlsVersion})]}),r.cipherSuite&&e.jsxs(g,{children:[e.jsx(c,{component:"th",scope:"row",children:s("cipherSuite")}),e.jsx(c,{children:r.cipherSuite})]})]})})})]}),r.alerts&&r.alerts.length>0&&e.jsxs(N,{severity:"warning",sx:{mt:2},children:[e.jsx(U,{children:s("securityAlerts")}),e.jsx("ul",{style:{margin:0,paddingLeft:20},children:r.alerts.map((i,p)=>e.jsx("li",{children:i},p))})]}),o.recommendations&&o.recommendations.length>0&&e.jsxs(N,{severity:"info",sx:{mt:2},children:[e.jsx(U,{children:s("recommendations")}),e.jsx("ul",{style:{margin:0,paddingLeft:20},children:o.recommendations.map((i,p)=>e.jsx("li",{children:i},p))})]}),e.jsxs(b,{mt:3,children:[e.jsx(d,{variant:"h6",gutterBottom:!0,children:s("serverInformation")}),e.jsx(J,{children:e.jsx(q,{size:"small","aria-label":s("serverInformation"),children:e.jsxs(_,{children:[e.jsxs(g,{children:[e.jsx(c,{component:"th",scope:"row",children:s("server")}),e.jsx(c,{children:o.server||s("unknown")})]}),e.jsxs(g,{children:[e.jsx(c,{component:"th",scope:"row",children:s("sslStatus")}),e.jsx(c,{children:o.sslStatus})]})]})})})]}),a.query&&e.jsxs(b,{mt:3,children:[e.jsx(d,{variant:"h6",gutterBottom:!0,children:s("ipGeolocation")}),e.jsxs(k,{container:!0,spacing:2,children:[a.city&&e.jsxs(k,{item:!0,xs:12,sm:6,children:[e.jsx(d,{variant:"body2",color:"text.secondary",children:s("city")}),e.jsx(d,{variant:"body1",children:a.city})]}),a.region&&e.jsxs(k,{item:!0,xs:12,sm:6,children:[e.jsx(d,{variant:"body2",color:"text.secondary",children:s("region")}),e.jsx(d,{variant:"body1",children:a.region})]}),a.country&&e.jsxs(k,{item:!0,xs:12,sm:6,children:[e.jsx(d,{variant:"body2",color:"text.secondary",children:s("country")}),e.jsx(d,{variant:"body1",children:a.country})]}),a.isp&&e.jsxs(k,{item:!0,xs:12,sm:6,children:[e.jsx(d,{variant:"body2",color:"text.secondary",children:s("isp")}),e.jsx(d,{variant:"body1",children:a.isp})]})]})]}),e.jsxs(d,{variant:"caption",color:"text.secondary",display:"block",mt:2,children:[s("checkedAt"),": ",new Date(o.checkedAt).toLocaleString()]})]})},Ie=()=>{const{t}=E(),[s,o]=u.useState(null),r=a=>{o(a)};return e.jsxs(re,{maxWidth:"lg",sx:{mt:4,mb:4},children:[e.jsx(d,{variant:"h4",component:"h1",gutterBottom:!0,children:t("addDomain")}),e.jsx(d,{variant:"body1",color:"text.secondary",paragraph:!0,children:t("subtitle")}),e.jsxs(b,{sx:{mt:3},children:[e.jsx(Ae,{onResult:r}),e.jsx(Be,{result:s})]})]})};export{Ie as default};
